////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

import mysql from "mysql2/promise"

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

import serverConfig from "@/config/env"

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

function generateDatabasePool(): mysql.Pool {
  try {
    const pool: mysql.Pool = mysql.createPool({
      host: serverConfig.db.HOST,
      user: serverConfig.db.USER,
      password: serverConfig.db.PASSWORD,
      database: serverConfig.db.DATABASE,
      waitForConnections: true,
      connectionLimit: 10,
      queueLimit: 0
    })
    return pool
  }
  catch (object: unknown) {
    const error = object as Error
    console.error("Error Generating Database Pool")
    console.log(error)
    throw error
  }
}

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

const db: mysql.Pool = generateDatabasePool()

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

export default db

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
