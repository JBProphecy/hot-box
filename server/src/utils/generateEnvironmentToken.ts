////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

import { UUID } from "crypto"
import jwt from "jsonwebtoken"

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

import serverConfig from "@/config/env"

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

const JWT_SECRET: string = serverConfig.secrets.JWT_SECRET

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

export type EnvironmentTokenPayload = { uuid: UUID }

export function generateEnvironmentToken(payload: EnvironmentTokenPayload): string {
  return jwt.sign(payload, JWT_SECRET)
}

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
