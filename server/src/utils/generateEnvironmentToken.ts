////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

import { UUID } from "crypto"
import jwt from "jsonwebtoken"

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

import serverConfig from "@/config/env"

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

const JWT_SECRET: string = serverConfig.secrets.JWT_SECRET

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

type EnvironmentTokenPayload = { uuid: UUID }

export default function generateEnvironmentToken(uuid: UUID): string {
  const payload: EnvironmentTokenPayload = { uuid }
  return jwt.sign(payload, JWT_SECRET)
}

////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
